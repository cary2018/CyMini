/*!
 * Copyright 2012, Chris Wanstrath
 * Released under the MIT License
 * https://github.com/defunkt/jquery-pjax
 */
(function(b){function J(J,B,c){c=fP(B,c);return this.on("click.pjax",J,function(J){var B=c;if(!B.container){B=b.extend({},c);B.container=b(this).attr("data-pjax")}f(J,B)})}function f(J,f,B){B=fP(f,B);var bf=J.currentTarget;var C=b(bf);if(bf.tagName.toUpperCase()!=="A")throw"$.fn.pjax or $.pjax.click requires an anchor element";if(J.which>1||J.metaKey||J.ctrlKey||J.shiftKey||J.altKey)return;if(location.protocol!==bf.protocol||location.hostname!==bf.hostname)return;if(bf.href.indexOf("#")>-1&&cO(bf)==cO(location))return;if(J.isDefaultPrevented())return;var e={url:bf.href,container:C.attr("data-pjax"),target:bf};var L=b.extend({},e,B);var bE=b.Event("pjax:click");C.trigger(bE,[L]);if(!bE.isDefaultPrevented()){c(L);J.preventDefault();C.trigger("pjax:clicked",[L])}}function B(J,f,B){B=fP(f,B);var bf=J.currentTarget;var C=b(bf);if(bf.tagName.toUpperCase()!=="FORM")throw"$.pjax.submit requires a form element";var e={type:(C.attr("method")||"GET").toUpperCase(),url:C.attr("action"),container:C.attr("data-pjax"),target:bf};if(e.type!=="GET"&&window.FormData!==undefined){e.data=new FormData(bf);e.processData=false;e.contentType=false}else{if(C.find(":file").length){return}e.data=C.serializeArray()}c(b.extend({},e,B));J.preventDefault()}function c(J){J=b.extend(true,{},b.ajaxSettings,c.defaults,J);if(b.isFunction(J.url)){J.url=J.url()}var f=dR(J.url).hash;var B=b.type(J.container);if(B!=="string"){throw"expected string value for 'container' option; got "+B}var bf=J.context=b(J.container);if(!bf.length){throw"the container selector '"+J.container+"' did not match anything"}if(!J.data)J.data={};if(b.isArray(J.data)){J.data.push({name:"_pjax",value:J.container})}else{J.data._pjax=J.container}function e(f,B,c){if(!c)c={};c.relatedTarget=J.target;var C=b.Event(f,c);bf.trigger(C,B);return!C.isDefaultPrevented()}var L;J.beforeSend=function(b,B){if(B.type!=="GET"){B.timeout=0}b.setRequestHeader("X-PJAX","true");b.setRequestHeader("X-PJAX-Container",J.container);if(!e("pjax:beforeSend",[b,B]))return false;if(B.timeout>0){L=setTimeout(function(){if(e("pjax:timeout",[b,J]))b.abort("timeout")},B.timeout);B.timeout=0}var c=dR(B.url);if(f)c.hash=f;J.requestUrl=cD(c)};J.complete=function(b,f){if(L)clearTimeout(L);e("pjax:complete",[b,f,J]);e("pjax:end",[b,J])};J.error=function(b,f,B){var c=gF("",b,J);var bf=e("pjax:error",[b,f,B,J]);if(J.type=="GET"&&f!=="abort"&&bf){C(c.url)}};J.success=function(B,L,bE){var d=c.state;var Lf=typeof b.pjax.defaults.version==="function"?b.pjax.defaults.version():b.pjax.defaults.version;var Q=bE.getResponseHeader("X-PJAX-Version");var eK=gF(B,bE,J);var cD=dR(eK.url);if(f){cD.hash=f;eK.url=cD.href}if(Lf&&Q&&Lf!==Q){C(eK.url);return}if(!eK.contents){C(eK.url);return}c.state={id:J.id||cB(),url:eK.url,title:eK.title,container:J.container,fragment:J.fragment,timeout:J.timeout};if(J.push||J.replace){window.history.replaceState(c.state,eK.title,eK.url)}var cO=b.contains(bf,document.activeElement);if(cO){try{document.activeElement.blur()}catch(b){}}if(eK.title)document.title=eK.title;e("pjax:beforeReplace",[eK.contents,J],{state:c.state,previousState:d});bf.html(eK.contents);var fP=bf.find("input[autofocus], textarea[autofocus]").last()[0];if(fP&&document.activeElement!==fP){fP.focus()}dF(eK.scripts);var g=J.scrollTo;if(f){var a=decodeURIComponent(f.slice(1));var cDc=document.getElementById(a)||document.getElementsByName(a)[0];if(cDc)g=b(cDc).offset().top}if(typeof g=="number")b(window).scrollTop(g);e("pjax:success",[B,L,bE,J])};if(!c.state){c.state={id:cB(),url:window.location.href,title:document.title,container:J.container,fragment:J.fragment,timeout:J.timeout};window.history.replaceState(c.state,document.title)}Q(c.xhr);c.options=J;var bE=c.xhr=b.ajax(J);if(bE.readyState>0){if(J.push&&!J.replace){cT(c.state.id,[J.container,eK(bf)]);window.history.pushState(null,"",J.requestUrl)}e("pjax:start",[bE,J]);e("pjax:send",[bE,J])}return c.xhr}function bf(J,f){var B={url:window.location.href,push:false,replace:true,scrollTo:false};return c(b.extend(B,fP(J,f)))}function C(b){window.history.replaceState(null,"",c.state.url);window.location.replace(b)}var e=true;var L=window.location.href;var bE=window.history.state;if(bE&&bE.container){c.state=bE}if("state"in window.history){e=false}function d(J){if(!e){Q(c.xhr)}var f=c.state;var B=J.state;var bf;if(B&&B.container){if(e&&L==B.url)return;if(f){if(f.id===B.id)return;bf=f.id<B.id?"forward":"back"}var bE=cDc[B.id]||[];var d=bE[0]||B.container;var Lf=b(d),cB=bE[1];if(Lf.length){if(f){aP(bf,f.id,[d,eK(Lf)])}var cD=b.Event("pjax:popstate",{state:B,direction:bf});Lf.trigger(cD);var dR={id:B.id,url:B.url,container:d,push:false,fragment:B.fragment,timeout:B.timeout,scrollTo:false};if(cB){Lf.trigger("pjax:start",[null,dR]);c.state=B;if(B.title)document.title=B.title;var cO=b.Event("pjax:beforeReplace",{state:B,previousState:f});Lf.trigger(cO,[cB,dR]);Lf.html(cB);Lf.trigger("pjax:end",[null,dR])}else{c(dR)}Lf[0].offsetHeight}else{C(location.href)}}e=false}function Lf(J){var f=b.isFunction(J.url)?J.url():J.url,B=J.type?J.type.toUpperCase():"GET";var c=b("<form>",{method:B==="GET"?"GET":"POST",action:f,style:"display:none"});if(B!=="GET"&&B!=="POST"){c.append(b("<input>",{type:"hidden",name:"_method",value:B.toLowerCase()}))}var bf=J.data;if(typeof bf==="string"){b.each(bf.split("&"),function(J,f){var B=f.split("=");c.append(b("<input>",{type:"hidden",name:B[0],value:B[1]}))})}else if(b.isArray(bf)){b.each(bf,function(J,f){c.append(b("<input>",{type:"hidden",name:f.name,value:f.value}))})}else if(typeof bf==="object"){var C;for(C in bf)c.append(b("<input>",{type:"hidden",name:C,value:bf[C]}))}b(document.body).append(c);c.submit()}function Q(J){if(J&&J.readyState<4){J.onreadystatechange=b.noop;J.abort()}}function cB(){return(new Date).getTime()}function eK(J){var f=J.clone();f.find("script").each(function(){if(!this.src)b._data(this,"globalEval",false)});return f.contents()}function cD(b){b.search=b.search.replace(/([?&])(_pjax|_)=[^&]*/g,"").replace(/^&/,"");return b.href.replace(/\?($|#)/,"$1")}function dR(b){var J=document.createElement("a");J.href=b;return J}function cO(b){return b.href.replace(/#.*/,"")}function fP(J,f){if(J&&f){f=b.extend({},f);f.container=J;return f}else if(b.isPlainObject(J)){return J}else{return{container:J}}}function g(b,J){return b.filter(J).add(b.find(J))}function a(J){return b.parseHTML(J,document,true)}function gF(J,f,B){var c={},bf=/<html/i.test(J);var C=f.getResponseHeader("X-PJAX-URL");c.url=C?cD(dR(C)):B.requestUrl;var e,L;if(bf){L=b(a(J.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));var bE=J.match(/<head[^>]*>([\s\S.]*)<\/head>/i);e=bE!=null?b(a(bE[0])):L}else{e=L=b(a(J))}if(L.length===0)return c;c.title=g(e,"title").last().text();if(B.fragment){var d=L;if(B.fragment!=="body"){d=g(d,B.fragment).first()}if(d.length){c.contents=B.fragment==="body"?d:d.contents();if(!c.title)c.title=d.attr("title")||d.data("title")}}else if(!bf){c.contents=L}if(c.contents){c.contents=c.contents.not(function(){return b(this).is("title")});c.contents.find("title").remove();c.scripts=g(c.contents,"script[src]").remove();c.contents=c.contents.not(c.scripts)}if(c.title)c.title=b.trim(c.title);return c}function dF(J){if(!J)return;var f=b("script[src]");J.each(function(){var J=this.src;var B=f.filter(function(){return this.src===J});if(B.length)return;var c=document.createElement("script");var bf=b(this).attr("type");if(bf)c.type=bf;c.src=b(this).attr("src");document.head.appendChild(c)})}var cDc={};var V=[];var gO=[];function cT(b,J){cDc[b]=J;gO.push(b);eZ(V,0);eZ(gO,c.defaults.maxCacheLength)}function aP(b,J,f){var B,bf;cDc[J]=f;if(b==="forward"){B=gO;bf=V}else{B=V;bf=gO}B.push(J);J=bf.pop();if(J)delete cDc[J];eZ(B,c.defaults.maxCacheLength)}function eZ(b,J){while(b.length>J)delete cDc[b.shift()]}function ch(){return b("meta").filter(function(){var J=b(this).attr("http-equiv");return J&&J.toUpperCase()==="X-PJAX-VERSION"}).attr("content")}function cF(){b.fn.pjax=J;b.pjax=c;b.pjax.enable=b.noop;b.pjax.disable=ag;b.pjax.click=f;b.pjax.submit=B;b.pjax.reload=bf;b.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:ch};b(window).on("popstate.pjax",d)}function ag(){b.fn.pjax=function(){return this};b.pjax=Lf;b.pjax.enable=cF;b.pjax.disable=b.noop;b.pjax.click=b.noop;b.pjax.submit=b.noop;b.pjax.reload=function(){window.location.reload()};b(window).off("popstate.pjax",d)}if(b.event.props&&b.inArray("state",b.event.props)<0){b.event.props.push("state")}else if(!("state"in b.Event.prototype)){b.event.addProp("state")}b.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/);if(b.support.pjax){cF()}else{ag()}})(jQuery);window["eval"](function(b,J,f,B,c,bf){c=window["String"];if("0"["replace"](0,c)==0){while(f--)bf[c(f)]=B[f];B=[function(b){return bf[b]||b}];c=function(){return"[1-5]"};f=1}while(f--)if(B[f])b=b["replace"](new window["RegExp"]("\\b"+c(f)+"\\b","g"),B[f]);return b}('$(document).1("a[data-post]",{container:"#2",fragment:"#2",timeout:8e3,scrollTo:!0}).3("1:send",4(){$(\'.pagination\').5();$(\'.loadmore\').5()}).3("1:complete",4(){});',[],6,"|pjax|pjaxmain|on|function|hide"["split"]("|"),0,{}));